<form [formGroup]="registerForm" (ngSubmit)="onSubmit()" novalidate class="space-y-6">

  <div>
    <label for="name" class="block text-sm font-medium text-gray-700">Nome Completo</label>
    <div class="mt-1">
      <input id="name" type="text" formControlName="name" placeholder="Seu nome"
             class="block w-full px-3 py-2 border rounded-md shadow-sm placeholder-gray-400 focus:outline-none
             focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
             [ngClass]="{ 'border-red-500': name?.invalid && name?.touched }">
    </div>

    @if (name?.invalid && (name?.dirty || name?.touched)) {
      <div class="mt-2 text-sm text-red-600">
        @if (name?.errors?.['required']) {
          <p>O nome é obrigatório.</p>
        }
        @if (name?.errors?.['minlength']) {
          <p>O nome precisa ter no mínimo 3 caracteres.</p>
        }
      </div>
    }
  </div>

  <div>
    <label for="email" class="block text-sm font-medium text-gray-700">E-mail</label>
    <div class="mt-1">
      <input id="email" type="email" formControlName="email" placeholder="seu@email.com"
             class="block w-full px-3 py-2 border rounded-md shadow-sm placeholder-gray-400 focus:outline-none
             focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
             [ngClass]="{ 'border-red-500': email?.invalid && email?.touched }">
    </div>

    @if (email?.invalid && (email?.dirty || email?.touched)) {
      <div class="mt-2 text-sm text-red-600">
        @if (email?.errors?.['required']) {
          <p>O e-mail é obrigatório.</p>
        }
        @if (email?.errors?.['email']) {
          <p>Por favor, insira um formato de e-mail válido.</p>
        }
      </div>
    }
  </div>

  <div>
    <label for="password" class="block text-sm font-medium text-gray-700">Senha</label>
    <div class="mt-1">
      <input id="password" type="password" formControlName="password" placeholder="Mínimo de 8 caracteres"
             class="block w-full px-3 py-2 border rounded-md shadow-sm placeholder-gray-400 focus:outline-none
             focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
             [ngClass]="{ 'border-red-500': password?.invalid && password?.touched }">
    </div>

    @if (password?.invalid && (password?.dirty || password?.touched)) {
      <div class="mt-2 text-sm text-red-600">
        @if (password?.errors?.['required']) {
          <p>A senha é obrigatória.</p>
        }
        @if (password?.errors?.['minlength']) {
          <p>A senha precisa ter no mínimo 8 caracteres.</p>
        }
      </div>
    }
  </div>

  <div>
    <label for="confirmPassword" class="block text-sm font-medium text-gray-700">Confirme a Senha</label>
    <div class="mt-1">
      <input id="confirmPassword" type="password" formControlName="confirmPassword"
             class="block w-full px-3 py-2 border rounded-md shadow-sm placeholder-gray-400 focus:outline-none
             focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
             [ngClass]="{ 'border-red-500': (confirmPassword?.invalid && confirmPassword?.touched) || (registerForm.errors?.['passwordsMismatch'] && confirmPassword?.touched) }">
    </div>

    @if ((confirmPassword?.invalid && confirmPassword?.touched) || (registerForm.errors?.['passwordsMismatch'] && confirmPassword?.touched)) {
      <div class="mt-2 text-sm text-red-600">
        @if (confirmPassword?.errors?.['required']) {
          <p>A confirmação da senha é obrigatória.</p>
        }
        @if (registerForm.errors?.['passwordsMismatch']) {
          <p>As senhas não conferem.</p>
        }
      </div>
    }
  </div>

  <div>
    <label for="role" class="block text-sm font-medium text-gray-700">Função</label>
    <div class="mt-1">
      <select id="role" formControlName="role"
              class="block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
              [ngClass]="{ 'border-red-500': role?.invalid && role?.touched }">
        @for (r of roles; track r) {
          <option [value]="r">{{ r | titlecase }}</option>
        }
      </select>
    </div>

    @if (role?.invalid && (role?.dirty || role?.touched)) {
      <div class="mt-2 text-sm text-red-600">
        @if (role?.errors?.['required']) {
          <p>A seleção de uma função é obrigatória.</p>
        }
      </div>
    }
  </div>

  <div>
    <button type="submit" [disabled]="registerForm.invalid"
            class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium
            text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500
                   disabled:bg-gray-400 disabled:cursor-not-allowed">
      Criar Conta
    </button>
  </div>
</form>
